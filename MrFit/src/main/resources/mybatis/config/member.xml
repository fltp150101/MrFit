<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">
 	<sql id="selectall">
 		select id,password,name,phone,address,email,point,totalspent,status,answer,qno,grade from member
 	</sql>
 	
 	<resultMap type="memberVO" id="MRM">
 		<result column="grade" property="gradeVO.grade"/>
 		<result column="percent" property="gradeVO.percent"/>
 	</resultMap>
 	<select id="findMemberById" parameterType="string" resultMap="MRM" resultType="memberVO">
 		SELECT	m.id,	m.password,  m.name, m.phone, m.address, m.email, m.grade, g.percent, m.point, 
		m.totalspent, m.status, m.answer, m.qno
		FROM	member m, GRADE g
		WHERE 	m.grade=g.grade and id=#{value}	and status='1'
 	</select>
 	
 	<select id="selectAuthorityById" parameterType="string" resultType="authority">
 		SELECT	id,auth 
		FROM	auth 
		WHERE	id=#{value}
 	</select>
 	
 	<insert id="registerMember" parameterType="memberVO">
		insert into member(id,	password,  name, phone, address, email, point, totalspent, status, answer, qno, grade)
		values(#{id},#{password},#{name},#{phone},#{address},#{email},0,0,'1',#{answer},#{qno},'브론즈')
	</insert>
 	
 	<insert id="registerRole" parameterType="authority">
		insert into auth (auth,id) values(#{auth},#{id})
	</insert>
 	
 	<select id="idcheck" parameterType="string" resultType="int">
		select count(*) from member where id=#{value}
	</select>
 
 	<select id="findIdByEmailAndName" parameterType="memberVO" resultType="string">
 		select id from member where email=#{email} and name=#{name}
 	</select>
 	
 	<select id="findQnaByIdNameEmail" parameterType="memberVO" resultType="string">
 		select question from question q where q.qno=(select qno from member where id=#{id} and name=#{name} and email=#{email})
 	</select>

 	<select id="findQuestionList" resultType="questionVO">
		select qno,question
		from question
	</select>
 	
 	<select id="findMemberByQna" parameterType="memberVO" resultType="memberVO">
 		select id, name from member where id=#{id} and name=#{name} and email=#{email} and answer=#{answer}
 	</select>
 	
 	<update id="updatePasswordById" parameterType="memberVO">
 		update member set password=#{password} where id=#{id}
 	</update>
 	
 	<insert id="registerMemberSize" parameterType="memberSizeVO">
 		insert into member_size(id, shoulder, chest, sleeve, armhole, toplength, waist, crotch, thigh, hem, bottomlength) 
 		values(#{id}, #{shoulder}, #{chest}, #{sleeve}, #{armhole}, #{toplength}, #{waist}, #{crotch}, #{thigh}, #{hem}, #{bottomlength})
 	</insert>
 	
 	<update id="updateMemberSize" parameterType="memberSizeVO">
 		update member_size 
 		set shoulder=#{shoulder}, chest=#{chest}, sleeeve=#{sleeve}, armhole=#{armhole}, toplength=#{toplength}, waist=#{waist}, crotch=#{crotch}, thigh=#{thigh}, hem=#{hem}, bottomlength=#{bottomlength} 
 		where id=#{id}
 	</update>
 	
 	<update id="updateMember" parameterType="memberVO">
		update member set password=#{password},name=#{name},address=#{address},email=#{email}
		where id=#{id}
	</update>
 	
 	
 	
</mapper>










